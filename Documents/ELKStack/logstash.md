# Logstash

## 로그스태시, 파일비트 개요

로그스태시
오픈 소스 서버측 데이터 처리로 파이프라인 역할
입력-필터-출력으로 이루어짐

입력
모든 소스, 사이즈 및 형태의 데이터 수집
(로그, 메트릭, 웹 어플리케이션, 데이터 저장소, 다양한 AWS 서비스)

필터
데이터 이동 중 구문 분석 및 변환
GROK 나열 , 비정형데이터에서 구조를 도출한다
GEO IP 지도 그릴 수 있는 IP 기반 좌표
FINGERPRINT
DATE 로그가 찍힌 시간이 안적혀있는 소스들도 있음. 이런것에 시간 지정 가능
데이터들이 생긴 그대로 엘라스틱서치로 올라가기엔 한계가 있음. 이를 보완하기 위해서 여러 필터가 존재

출력
엘라스틱 서치가 될 수도 있고, 메일로 알림을 줄 수도 있고, 데이터베이스가 될 수도 있음
다양한 곳에 저장 가능

file
geoip
stdout
elasticsearch
등의 플러그인을 사용하여 설정해야함(json파일에)

### 로그스태시의 플러그인

#### Input
file 로그들을 출력해주고 끝나지 않고 발생하면 엘라스틱서치에 넘기고
syslog 메시지 구문 분석
redis 데이터베이스. redis 서버에서 읽음
beat filebeat에서 보낸 이벤트를 처리 (파일 비트는 알려진 파일의 형태에 대해서는 스스로 그 형식을 분석하고 읽어들일 수 있는 기능을 가지고 있음)

#### Filter
grok
mutate 일반적인 변환. 데이터 수정 및 제거
drop 이벤트 완전 삭제
clone 이벤트 복사(2개 이상의 필드에 포함시키고 싶을 때)
geoip ip주소의 지리적 위치에 대한 정보를 추가(ip주면 위도 경도줌. kibana의 지도 차트로 사용)

#### Output
elasticsearch에 데이터 전송 - http프로토콜 사용
file 디스크의 파일로 저장
graphite 이벤트 데이터를 graphite 애플리케이션에 저장
statsd 집계 역할 하는 애플리케이션에 보낼 수 있음

#### Codec
json
multiline

### 파일비트
로그와 파일을 경량화된 방식으로 전달하고 중앙 집중화하여 작업을 간편하게 유지해줌
로그스태시의 어려운 점들을 간편하게 할 수 있게 도와주는 역할
