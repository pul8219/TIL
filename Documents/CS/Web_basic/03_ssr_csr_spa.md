# 웹의 역사

## Static Sites(1990s)

- 사용자가 주소에 접속하면 서버에 이미 배포되어 있는 html 페이지를 받아와서 보여주는 방식
- 페이지 내 다른 링크에 접속할 경우 서버에서 다시 해당 페이지의 HTML을 받아와서 페이지 전체가 업데이트 되어야 하기 때문에 사용성이 떨어진다.

## iframe 태그(1996)

- iframe 태그의 도입: 문서 내에 또 다른 문서를 담을 수 있다.

## XMLHttpRequest(1998~)

- fetch API의 원조. HTML 문서 전체가 아니라 필요한 데이터(JSON과 같은 포맷)만 서버에서 받아올 수 있게 된다. 자바스크립트로 이 데이터를 이용해 HTML 요소를 동적으로 생성해 페이지에 업데이트하는 방식이다.

## AJAX(2005)

- `XMLHttpRequest` 방식에 `AJAX`라는 공식 명칭이 붙게 되었다.
- 이것이 `SPA(Single Page Application)`이다.
- 사용자가 하나의 페이지에 머무르면서 필요한 데이터만 서버로부터 받아와 부분적으로만 업데이트하는 것.
- AJAX에 대한 자세한 사항은 [AJAX 정리 문서]('./04_ajax.md') 참고

# SSR, CSR

SSR, CSR 중 어느 게 더 낫다라는 것은 없고, 다음 요소를 고려하며 유연하게 섞어서 개발을 해야한다.

- 제공하려는 웹사이트가 정적인지, 동적인지
- 서버에서 동적으로 데이터를 받아오는지
- 얼마나 자주, 얼마나 많은 사용자가 있는지
- TTV, TTI를 고려해서

## CSR(Client-Side Rendering)

- 서버에서 HTML파일(껍데기)을 받아 사용자의 동작에 따라 클라이언트 측에서 렌더링하는 방식. 클라이언트측에서 많은 일을 하는 방식이다.
- JavaScript가 발전하면서 클라이언트 단에서 모든 렌더링을 처리하려는 시도로 `React`, `Angular`, `Vue` 와 같은 프레임워크(혹은 라이브러리)가 탄생하였다.
- 클라이언트(브라우저)단에서 렌더링하기 위해선 렌더링에 필요한 상태를 정교하게 관리해야 한다.
- 그래서 `Redux` 같은 상태관리 라이브러리(혹은 프레임워크)가 생겼다.

```
1-1. 클라이언트 -> 서버: 요청(웹사이트 접속)
1-2. 서버 -> 클라이언트: index.html와 같은 파일을 다운로드

index.html은 보통 아래 코드처럼 생겼기 때문에 처음에는 텅텅 빈 화면이 보이게 된다.

<div id="root"></div>
<script src="app.js"></script>

2-1. 클라이언트 -> 서버: HTML파일에 명세된 app.js 요청
2-2. 서버 -> 클라이언트: app.js와 같은 파일(어플리케이션 로직, 라이브러리의 소스코드 등이 모두 포함되어 있는)을 서버로부터 다운로드한다. app.js와 같은 역할의 파일은 보통 크기가 크다.

3-1. 클라이언트 -> 서버: 추가로 필요한 데이터가 있다면 서버에 요청
3-2. 서버 -> 클라이언트: 서버로부터 데이터를 받아와 JS나 프레임워크를 통해(app.js) 동적으로 HTML 요소를 생성

4. 위 작업을 모두 거치면 사용자는 최종적인 어플리케이션 모습을 볼 수 있고(viewable) 클릭할 수 있다.(interactable) ⭐
```

### CSR의 단점

1. 사용자가 초기 화면을 보기까지 시간이 너무 오래 걸린다.(Initial Loading may take too long)

2. SEO가 좋지 않다.(Low SEO)

   - CSR에서 사용되는 HTML의 body는 대부분 텅텅 비어있기 때문에 검색엔진들이 CSR로 작성된 웹페이지를 분석하는데 어려움을 겪는다.

> **SEO(Search Engine Optimization)**
>
> 구글, 네이버와 같은 검색엔진들은 서버에 등록된 웹사이트들을 돌며 웹사이트의 HTML을 분석(타이틀, 설명 등을 보고 이런 검색어로 찾아질 수 있는 웹사이트이군, HTML에 이런 링크가 있으니 이것도 검색엔진에 등록해놔야겠어)하고 판단한다. 검색시 웹사이트를 빠르게 검색할 수 있게 도와준다.

### CSR 관련 해볼 수 있는 고민들

- 번들링하여 최종적으로 보내는 JS 파일을(ex.app.js 관련) 효율적으로 분할하는 방법을 고민할 필요가 있다. 이를 통해 초기에 사용자에게 보여지는 화면에 최소한의 필수적인 요소들만 보이게 해야 한다.

## SSR(Server-Side Rendering)

- 서버에서 필요한 데이터들을 가져와 HTML 파일을 만들고 자바스크립트 코드와 함께 클라이언트에게 넘겨주는 방식 Ex) `JSP`, `PHP`, `ASP` Static Sites 에서 영감을 얻은 방식이다.
- 사용자의 요청마다 서버에서 HTML파일을 받아오게 되며 새로고침이 발생한다.
- 그래서 클라이언트단(브라우저)에서는 굳이 데이터를 정교하게 관리할 필요가 없었다.

```
1-1. 클라이언트 -> 서버: 웹사이트에 접속
1-2. 서버 -> 클라이언트: 서버는 필요한 데이터를 가져와 HTML파일을 만들고 이 HTML파일과 JS(조금의 제어 가능한)를 클라이언트에게 보낸다. -> 이때부터 사용자는 (초기) 웹사이트를 볼 수 있다.(viewable)(아직 동적으로 제어할 수 있는 자바스크립트 파일을 다운받은 것은 아니기 때문에 사용자가 클릭을 해도 아무런 것도 처리할 수 없다.)

2-1. 클라이언트 -> 서버: JS 파일(app.js) 요청
2-2. 서버 -> 클라이언트: 클라이언트는 app.js파일을 서버로부터 다운로드 -> 이때부터 사용자의 클릭을 처리할 수 있는 인터랙션이 가능해진다.(interactable)
```

### SSR의 장점

1. CSR을 사용했을 때 보다 페이지 로딩이 빨라진다.(Initial page load is faster)
2. 효율적인 SEO(모든 컨텐츠가 HTML에 담겨있기 때문에)

### SSR의 문제점

1. Static Sites에서와 같이 깜빡임 이슈가 있다.(Blinking issue, Non-rich site interactions)

   - 사용자가 클릭을 하면 전체적인 웹사이트를 서버에서 다시 받아오기 때문에 사용자 경험이 나빠질 수 있다.

2. 서버에 과부하가 걸리기 쉽다.(Server side overhead)

   - 사용자가 많을 경우, 사용자의 클릭마다 서버에 요청이 가고 서버에서 필요한 데이터를 가져와 HTML을 만드는 과정이 이루어지므로 서버에 과부하가 걸리기가 쉽다.

3. `TTV`와 `TTI` 사이의 공백이 길어 발생하는 문제(Need to wait before interacting)

   - 사용자가 초기 페이지를 빠르게 확인할 수 있지만 동적으로 데이터를 처리하는 자바스크립트가 다운로드되기 전에 사용자가 이곳 저곳을 클릭하면 반응이 없는 경우가 발생할 수 있다.

### SSR 관련 해볼 수 있는 고민들

- TTV(사용자가 볼 수 있는 시점)와 TTI(사용자의 인터랙션이 가능한 시점) 사이 시간차를 줄일 수 있는 방법을 고민해야 한다.

# TTV와 TTI

둘 모두 웹사이트의 성능을 분석하는데 중요한 역할을 하는 측정도구이다.

- TTV(Time To View): 사용자가 웹사이트를 볼 수 있는 때
- TTI(Time To Interact): 사용자가 클릭을 하거나 인터랙션을 할 수 있는 때

# SSG

SSG(Static Site Generation)

## React + Gatsby

- React: CSR에 특화된 라이브러리
- Gatsby: 라이브러리

React + Gatsby를 같이 사용하면, 리액트로 만든 웹어플리케이션을 정적으로 웹페이지 생성을 미리 해두어서 서버에 배포해놓을 수 있다. 정적인 처리는 물론이고 웹페이지가 자바스크립트 파일을 함께 가지고 있을 수 있어 동적인 요소도 추가할 수 있다.

## React + Next.js

- React
- Next.js: 강력한 SSR을 지원하는 라이브러리. 요즘에는 SSG도 지원한다.

# References

- [SSR, CSR, SPA, TTV, TTI - 드림코딩 엘리](https://www.youtube.com/watch?v=iZ9csAfU5Os)

https://github.com/baeharam/Must-Know-About-Frontend/blob/main/Notes/frontend/csr-ssr.md

https://gitlab.com/siots-study/topics/-/wikis/SPA&SSR&CSR

https://www.grabbing.me/3a44d95ce316417ab182370d09fd2bfe#61d893028ded42ba9d786104c088fc2c
